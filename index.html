---
layout: default
title: PIXL8R - Retro Image Pixelation Tool
---
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PIXL8R - Retro Image Pixelation Tool</title>
    <meta name="description" content="Transform your images into retro pixel art with PIXL8R - the Game Boy inspired pixelation tool. Choose from classic palettes and create stunning 8-bit style artwork.">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap');

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            background: #ffcd75;
            font-family: "Pixelify Sans", sans-serif;
            min-height: 100vh;
            line-height: 1.6;
        }

        .header {
            background: #ffcd75;
            padding: 20px 0;
            
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 32px;
            font-weight: 900;
            color: #5a4a3a;
            letter-spacing: 3px;
            text-decoration: none;
            text-transform: uppercase;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-links a {
            color: #5a4a3a;
            text-decoration: none;
            font-weight: 700;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #8b4513;
        }

        .hero {
            padding: 10px 0;
            text-align: center;
        }

        .hero h1 {
            font-size: 48px;
            font-weight: 900;
            color: #5a4a3a;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .hero p {
            font-size: 20px;
            color: #8b4513;
            margin-bottom: 10px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-button {
            display: inline-block;
            background: #c17b5a;
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 8px;
            border: 5px solid #5a4a3a;
            font-weight: 700;
            font-size: 18px;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            box-shadow: 6px 6px 0 #8b4513;
            text-shadow: 0 2px 0 #8b4513;
        }

        .cta-button:hover {
            background: #d18b6a;
            transform: translate(2px, 2px);
            box-shadow: 4px 4px 0 #8b4513;
        }

        .main-content {
            display: flex;
            justify-content: center;
            padding: 40px 0;
            min-height: 60vh;
        }

        .gameboy {
            width: 420px;
            height: 780px;
            background: #f2f0e8;
            border: 6px solid #5a4a3a;
            border-radius: 38px 38px 30px 30px;
            position: relative;
            padding: 30px;
            box-shadow: 6px 6px 0 0 #5a4a3a;
        }

        .top-section {
            margin-top: 0px;
            margin-bottom: 15px;
            text-align: center;
        }

        .gameboy-title {
            font-size: 21px;
            font-weight: 900;
            color: #8b4513;
            letter-spacing: 4.5px;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .screen-container {
            background: #7a6b5d;
            border: 6px solid #5a4a3a;
            border-radius: 23px;
            padding: 23px;
            margin-bottom: 30px;
            position: relative;
            box-shadow: inset 3px 3px 5px rgba(0, 0, 0, 0.25), 
                inset -2px -2px 4px rgba(255, 255, 255, 0.7);
        }

        .power-indicator {
            position: absolute;
            top: 50%;
            left: 5px;
            transform: translateY(-50%);
            z-index: 10;
        }

        .power-light {
    width: 15px;
    height: 15px;
    background: #4CAF50;
    border: 3px solid #5a4a3a;
    border-radius: 50%;
    box-shadow: inset 1px 1px 2px rgba(0,0,0,0.5);
}

        .screen {
            background: #9bbc0f;
            height: 240px;
            border: 5px solid #5a4a3a;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            transition: background-color 0.2s ease;
            box-shadow: inset 3px 3px 0 0 rgba(0,0,0,0.2);
        }

        .upload-zone {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 8px;
        }

        .upload-zone:hover {
            background: rgba(139, 172, 15, 0.2);
        }

        .upload-zone.dragover {
            background: rgba(139, 172, 15, 0.4);
            transform: scale(1.02);
        }

        .upload-zone.has-image {
            padding: 0;
        }

        .upload-prompt {
            text-align: center;
            color: #0f380f;
            font-weight: 700;
        }

        .upload-text {
            font-size: 38px;
            margin-bottom: 5px;
        }

        .upload-hint {
            font-size: 12px;
            opacity: 0.7;
        }

        .image-preview {
            width: 100%;
            height: 100%;
            position: relative;
            display: none;
            border-radius: 8px;
            overflow: hidden;
            padding-top: 3px;
            padding-left: 3px;
        }

        .upload-zone.has-image .upload-prompt {
            display: none;
        }

        .upload-zone.has-image .image-preview {
            display: block;
        }

        .preview-canvas {
            width: 100%;
            height: 100%;
            object-fit: contain;
            image-rendering: pixelated;
        }

        .image-overlay {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(15, 56, 15, 0.8);
            color: #9bbc0f;
            border-radius: 3px;
            padding: 2px 6px;
            font-size: 11px;
            font-weight: 700;
        }

        .change-image {
            position: absolute;
            bottom: 5px;
            left: 5px;
            background: rgba(15, 56, 15, 0.8);
            color: #9bbc0f;
            border: none;
            border-radius: 3px;
            padding: 2px 6px;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            font-family: "Pixelify Sans", sans-serif;
        }

        .change-image:hover {
            background: rgba(15, 56, 15, 1);
        }

        input[type="file"] {
            display: none;
        }

        .controls-section {
            margin-bottom: 30px;
        }

        .pixel-control {
            background: #e6ddd4;
            border: 5px solid #5a4a3a;
            border-radius: 18px;
            padding: 15px;
            margin-bottom: 23px;
            box-shadow: inset 3px 3px 5px rgba(0, 0, 0, 0.25), 
                inset -2px -2px 4px rgba(255, 255, 255, 0.7);
        }

        .control-label {
            font-size: 14px;
            font-weight: 700;
            color: #5a4a3a;
            margin-bottom: 9px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            text-align: center;
        }

        .kawaii-slider {
            width: 100%;
            height: 30px;
            background: #f8f5f0;
            border: 3px solid #5a4a3a;
            border-radius: 15px;
            outline: none;
            cursor: pointer;
            -webkit-appearance: none;
        }

        .kawaii-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: #c17b5a;
            border: 3px solid #5a4a3a;
            border-radius: 50%;
            cursor: pointer;
        }

        .kawaii-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #c17b5a;
            border: 3px solid #5a4a3a;
            border-radius: 50%;
            cursor: pointer;
        }

        .button-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 0 15px;
        }

        .dpad {
            width: 105px;
            height: 105px;
            position: relative;
        }

        .dpad-bg {
            width: 100%;
            height: 100%;
            background: #a0907d;
            border: 6px solid #5a4a3a;
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
           box-shadow: inset 3px 3px 5px rgba(0, 0, 0, 0.25), 
                inset -2px -2px 4px rgba(255, 255, 255, 0.7);
        }

        .dpad-bg:hover {
            background: #b5a48e;
             transform: none;
            box-shadow: inset 3px 3px 5px rgba(0, 0, 0, 0.25), 
                inset -2px -2px 4px rgba(255, 255, 255, 0.7);
        }

        .dpad-bg:active {
             transform: none;
            box-shadow: inset 4px 4px 6px rgba(0, 0, 0, 0.35);
        }

        .dpad-cross {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 75px;
            height: 75px;
        }

        .dpad-horizontal {
            width: 75px;
            height: 23px;
            background: #5a4a3a;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 5px;
        }

        .dpad-vertical {
            width: 23px;
            height: 75px;
            background: #5a4a3a;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 5px;
        }

        .action-buttons {
            background: #8b7355;
            border: 6px solid #5a4a3a;
            border-radius: 38px;
            padding: 12px 18px;
            display: flex;
            gap: 15px;
            align-items: center;
            box-shadow: inset 3px 3px 5px rgba(0, 0, 0, 0.25), 
                inset -2px -2px 4px rgba(255, 255, 255, 0.7);
        }

        .action-button {
            width: 53px;
            height: 53px;
            border-radius: 50%;
            border: 5px solid #5a4a3a;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            font-family: "Pixelify Sans", sans-serif;
            transition: all 0.2s ease;
            background: #c17b5a;
            color: white;
            text-shadow: 0 2px 0 #8b4513;
            box-shadow: 5px 5px 0 #8b4513;
        }

        .action-button:hover:not(:disabled) {
            background: #d18b6a;
            transform: translate(1.5px, 1.5px);
            box-shadow: 3.5px 3.5px 0 #8b4513;
        }

        .action-button:active:not(:disabled) {
            transform: translate(3px, 3px);
            box-shadow: 2px 2px 0 #8b4513;
        }

        .action-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #a0907d;
            color: #d4c5a9;
            text-shadow: none;
            box-shadow: 5px 5px 0 #6b5a47;
        }

        .status-display {
    background: #f8f5f0;
    border: 6px solid #5a4a3a;
    border-radius: 12px;
    padding: 9px 15px;
    font-size: 12px;
    font-weight: 700;
    color: #5a4a3a;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    margin-bottom: 23px;
    box-shadow: inset 3px 3px 5px rgba(0, 0, 0, 0.2);
}
        .footer {
            background: #f2f0e8;
            padding: 60px 0 40px;
            margin-top: 60px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-section h3 {
            font-size: 20px;
            font-weight: 900;
            color: #5a4a3a;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .footer-section p, .footer-section li {
            color: #8b4513;
            margin-bottom: 10px;
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
        }

        .footer-section a {
            color: #8b4513;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: #5a4a3a;
        }

        .footer-bottom {
            border-top: 3px solid #8b4513;
            padding-top: 20px;
            text-align: center;
            color: #8b4513;
            font-size: 14px;
        }

        .features {
            background: #f2f0e8;
            padding: 60px 0;
            margin: 40px 0;
            border: 6px solid #5a4a3a;
            border-radius: 20px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }

        .feature {
            text-align: center;
            padding: 20px;
        }

        .feature h3 {
            font-size: 18px;
            font-weight: 900;
            color: #5a4a3a;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .feature p {
            color: #8b4513;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .nav {
                flex-direction: column;
                gap: 20px;
            }

            .nav-links {
                gap: 20px;
            }

            .hero h1 {
                font-size: 36px;
            }

            .hero p {
                font-size: 18px;
            }

            .gameboy {
                width: 100%;
                max-width: 405px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="/" class="logo">PIXL8R</a>
                
            </nav>
        </div>
    </header>

    <main>
        <section class="hero">
            <div class="container">
                <h1>Turn Any Image Into Pixel Art</h1>
                <p>Experience the nostalgic charm of Game Boy graphics with our pixel art creator. Choose from authentic retro palettes and bring your images to life in 8-bit style.</p>
            </div>
        </section>

        <section class="main-content">
            <div class="gameboy">
                <div class="top-section">
                    <div class="gameboy-title">PIXL8R</div>
                </div>

                <div class="screen-container">
                    <div class="power-indicator">
                        <div class="power-light"></div>
                    </div>
                    <div class="screen">
                        <div class="upload-zone" id="uploadZone">
                            <input type="file" id="fileInput" accept="image/*">
                            <div class="upload-prompt">
                                <div class="upload-text">Drop Image</div>
                                <div class="upload-hint">or tap to browse</div>
                            </div>
                            <div class="image-preview">
                                <canvas class="preview-canvas" id="canvas"></canvas>
                                <div class="image-overlay" id="imageInfo"></div>
                                <button class="change-image" id="changeImage">change</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="controls-section">
                    <div class="pixel-control">
                        <div class="control-label">Pixel Size</div>
                        <input type="range" class="kawaii-slider" id="pixelSize" min="2" max="32" value="8">
                    </div>
                </div>

                <div class="button-section">
                    <div class="dpad">
                        <div class="dpad-bg">
                            <div class="dpad-cross">
                                <div class="dpad-horizontal"></div>
                                <div class="dpad-vertical"></div>
                            </div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="action-button" id="resetBtn" disabled>R</button>
                        <button class="action-button" id="downloadBtn" disabled>S</button>
                    </div>
                </div>

                <div class="status-display" id="status">Ready to Pixel • Game Boy</div>
            </div>
        </section>

    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>About PIXL8R</h3>
                    <p>PIXL8R is a retro-inspired image pixelation tool that transforms your photos into stunning 8-bit artwork. Inspired by the classic Game Boy aesthetic, our tool makes pixel art creation accessible to everyone - no artistic skills required!</p>
                    <p>Perfect for game developers, social media creators, designers, and anyone who appreciates the nostalgic charm of retro graphics. Turn any photo into unique pixel art in seconds.</p>
                </div>
                
                <div class="footer-section">
                    <h3>Features</h3>
                    <ul>
                        <li><a href="/">Drag & Drop Image Upload</a></li>
                        <li><a href="/">Multiple Retro Palettes</a></li>
                        <li><a href="/">Adjustable Pixel Sizes</a></li>
                        <li><a href="/">High-Quality PNG Export</a></li>
                        <li><a href="/">Mobile-Friendly Interface</a></li>
                    </ul>
                </div>
                
               
                
                <div class="footer-section">
                    <h3>Use Cases</h3>
                    <ul>
                        <li><a href="/">Game Development Assets</a></li>
                        <li><a href="/">Social Media Content</a></li>
                        <li><a href="/">Retro Art & Design</a></li>
                        <li><a href="/">Album Covers & Posters</a></li>
                        <li><a href="/">Profile Pictures & Avatars</a></li>
                        <li><a href="/">Marketing Materials</a></li>
                    </ul>
					<h2>Latest Posts</h2>
<ul>
  {% for post in site.posts %}
    <li>
      <a href="/pixl8r{{ post.url }}">{{ post.title }}</a>
    </li>
  {% endfor %}
</ul>
                </div>
                
                <div class="footer-section">
                    <h3>Connect</h3>
                    <ul>
                        <li><a href="/contact">Contact Us</a></li>
                        <li><a href="/support">Support</a></li>
                        <li><a href="https://github.com/pixl8r" target="_blank">GitHub</a></li>
                        <li><a href="https://twitter.com/pixl8r" target="_blank">Twitter</a></li>
                        <li><a href="/newsletter">Newsletter</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 PIXL8R.com - Bringing retro pixel art to the modern world. Made with pixels and passion.</p>
            </div>
        </div>
    </footer>

    <script>
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const changeImage = document.getElementById('changeImage');
        const pixelSize = document.getElementById('pixelSize');
        const resetBtn = document.getElementById('resetBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const status = document.getElementById('status');
        const canvas = document.getElementById('canvas');
        const imageInfo = document.getElementById('imageInfo');
        const ctx = canvas.getContext('2d');

        let originalImage = null;
        let selectedPalette = 'gameboy'; // Start with gameboy palette

        // Expanded palette collection (cycling through with D-pad)
        const palettes = {
            natural: [],
            gameboy: [[15,56,15], [48,98,48], [139,172,15], [155,188,15]],
            pico8: [
                [0,0,0], [29,43,83], [126,37,83], [0,135,81], [171,82,54], [95,87,79], [194,195,199],
                [255,241,232], [255,0,77], [255,163,0], [255,236,39], [0,228,54], [41,173,255], 
                [131,118,156], [255,119,168], [255,204,170]
            ],
            sweetie16: [
                [26,28,44], [93,39,93], [177,62,83], [239,125,87], [255,205,117], [167,240,112], 
                [56,183,100], [37,113,121], [41,54,111], [59,93,201], [65,166,246], [115,239,247],
                [244,244,244], [148,176,194], [86,108,134], [51,60,87]
            ],
            c64: [
                [0,0,0], [255,255,255], [136,57,50], [103,182,189], [139,63,150], [85,160,73],
                [64,49,141], [191,206,114], [139,84,41], [87,66,0], [184,105,98], [80,80,80],
                [120,120,120], [148,224,137], [120,105,196], [159,159,159]
            ],
            nes: [
                [124,124,124], [0,0,252], [0,0,188], [68,40,188], [148,0,132], [168,0,32],
                [168,16,0], [136,20,0], [80,48,0], [0,120,0], [0,104,0], [0,88,0],
                [0,64,88], [0,0,0], [188,188,188], [0,120,248], [0,88,248], [104,68,252],
                [216,0,204], [228,0,88], [248,56,0], [228,92,16], [172,124,0], [0,184,0],
                [0,168,0], [0,168,68], [0,136,136], [248,248,248], [60,188,252], [104,136,252],
                [152,120,248], [248,120,248], [248,88,152], [248,120,88], [252,160,68], [248,184,0],
                [184,248,24], [88,216,84], [88,248,152], [0,232,216], [120,120,120], [252,252,252]
            ],
            cga: [
                [0,0,0], [0,0,170], [0,170,0], [0,170,170], [170,0,0], [170,0,170],
                [170,85,0], [170,170,170], [85,85,85], [85,85,255], [85,255,85], [85,255,255],
                [255,85,85], [255,85,255], [255,255,85], [255,255,255]
            ],
            mono: [[0,0,0], [255,255,255]],
            sepia: [
                [112,66,20], [140,85,31], [168,107,46], [196,129,61], [224,151,76],
                [252,173,91], [255,196,115], [255,218,139], [255,240,163], [255,255,187]
            ]
        };

        const paletteNames = {
            natural: 'NATURAL',
            gameboy: 'GAME BOY',
            pico8: 'PICO-8',
            sweetie16: 'SWEETIE-16',
            c64: 'C64',
            nes: 'NES',
            cga: 'CGA',
            mono: 'MONO',
            sepia: 'SEPIA'
        };
        function getImageBackgroundColor() {
            if (!canvas.width || !canvas.height) return null;
            
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            const colorCounts = {};
            const sampleSize = 10;
            
            const edgePixels = [];
            
            for (let x = 0; x < canvas.width; x += sampleSize) {
                edgePixels.push([x, 0]);
                edgePixels.push([x, canvas.height - 1]);
            }
            
            for (let y = 0; y < canvas.height; y += sampleSize) {
                edgePixels.push([0, y]);
                edgePixels.push([canvas.width - 1, y]);
            }
            
            edgePixels.forEach(([x, y]) => {
                const index = (y * canvas.width + x) * 4;
                const r = data[index];
                const g = data[index + 1];
                const b = data[index + 2];
                const colorKey = `${r},${g},${b}`;
                colorCounts[colorKey] = (colorCounts[colorKey] || 0) + 1;
            });
            
            let maxCount = 0;
            let dominantColor = null;
            
            for (const [colorKey, count] of Object.entries(colorCounts)) {
                if (count > maxCount) {
                    maxCount = count;
                    const [r, g, b] = colorKey.split(',').map(Number);
                    dominantColor = `rgb(${r}, ${g}, ${b})`;
                }
            }
            
            return dominantColor;
        }

        function selectPalette(key) {
            selectedPalette = key;
            
            if (originalImage) {
                processImage();
                // Only change background color for natural palette or when there's a dominant color
                if (selectedPalette === 'natural') {
                    const bgColor = getImageBackgroundColor();
                    if (bgColor) {
                        document.querySelector('.screen').style.backgroundColor = bgColor;
                    } else {
                        document.querySelector('.screen').style.backgroundColor = '#f0f0f0'; // Light gray for natural
                    }
                } else {
                    const bgColor = getImageBackgroundColor();
                    if (bgColor) {
                        document.querySelector('.screen').style.backgroundColor = bgColor;
                    } else {
                        document.querySelector('.screen').style.backgroundColor = '#9bbc0f';
                    }
                }
            } else {
                // Set default background based on palette
                if (selectedPalette === 'natural') {
                    document.querySelector('.screen').style.backgroundColor = '#f0f0f0';
                } else {
                    document.querySelector('.screen').style.backgroundColor = '#9bbc0f';
                }
            }
            
            updateStatus();
        }

        function updateStatus() {
            const paletteName = paletteNames[selectedPalette];
            const baseStatus = status.textContent.split(' • ')[0];
            status.textContent = `${baseStatus} • ${paletteName}`;
        }

        document.querySelector('.dpad').addEventListener('click', function(e) {
            e.preventDefault();
            
            const paletteKeys = Object.keys(palettes);
            const currentIndex = paletteKeys.indexOf(selectedPalette);
            const nextIndex = (currentIndex + 1) % paletteKeys.length;
            
            selectPalette(paletteKeys[nextIndex]);
        });

        document.addEventListener('keydown', function(e) {
            const paletteKeys = Object.keys(palettes);
            const currentIndex = paletteKeys.indexOf(selectedPalette);
            
            if (e.key === 'ArrowUp' || e.key === 'ArrowRight') {
                e.preventDefault();
                const nextIndex = (currentIndex + 1) % paletteKeys.length;
                selectPalette(paletteKeys[nextIndex]);
            } else if (e.key === 'ArrowDown' || e.key === 'ArrowLeft') {
                e.preventDefault();
                const prevIndex = (currentIndex - 1 + paletteKeys.length) % paletteKeys.length;
                selectPalette(paletteKeys[prevIndex]);
            }
        });

        uploadZone.addEventListener('click', () => fileInput.click());
        changeImage.addEventListener('click', (e) => {
            e.stopPropagation();
            fileInput.click();
        });

        fileInput.addEventListener('change', function(e) {
            const file = e.target.files?.[0];
            if (file) handleFile(file);
        });

        let dragCounter = 0;

        uploadZone.addEventListener('dragenter', function(e) {
            e.preventDefault();
            dragCounter++;
            uploadZone.classList.add('dragover');
        });

        uploadZone.addEventListener('dragover', (e) => e.preventDefault());

        uploadZone.addEventListener('dragleave', function(e) {
            e.preventDefault();
            dragCounter--;
            if (dragCounter <= 0) {
                uploadZone.classList.remove('dragover');
                dragCounter = 0;
            }
        });

        uploadZone.addEventListener('drop', function(e) {
            e.preventDefault();
            dragCounter = 0;
            uploadZone.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) handleFile(files[0]);
        });

        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                status.textContent = 'Invalid File Type';
                return;
            }
            
            status.textContent = 'Loading...';
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    originalImage = img;
                    selectedPalette = 'gameboy'; // Reset to gameboy when loading new image
                    
                    uploadZone.classList.add('has-image');
                    imageInfo.textContent = `${img.width}×${img.height}`;
                    
                    processImage();
                    resetBtn.disabled = false;
                    downloadBtn.disabled = false;
                    status.textContent = 'Cartridge Loaded';
                    updateStatus();
                };
                img.onerror = () => status.textContent = 'Failed to Load Image';
                img.src = e.target.result;
            };
            reader.onerror = () => status.textContent = 'File Read Error';
            reader.readAsDataURL(file);
        }

        pixelSize.addEventListener('input', () => {
            if (originalImage) processImage();
        });

        function processImage() {
            if (!originalImage) return;
            
            const maxSize = 600;
            let width = originalImage.width;
            let height = originalImage.height;
            
            if (width > maxSize || height > maxSize) {
                const scale = Math.min(maxSize / width, maxSize / height);
                width = Math.round(width * scale);
                height = Math.round(height * scale);
            }

            canvas.width = width;
            canvas.height = height;

            const pixelSizeValue = parseInt(pixelSize.value);
            const smallWidth = Math.max(1, Math.floor(width / pixelSizeValue));
            const smallHeight = Math.max(1, Math.floor(height / pixelSizeValue));

            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            tempCanvas.width = smallWidth;
            tempCanvas.height = smallHeight;
            
            tempCtx.imageSmoothingEnabled = true;
            tempCtx.drawImage(originalImage, 0, 0, smallWidth, smallHeight);

            ctx.imageSmoothingEnabled = false;
            ctx.clearRect(0, 0, width, height);
            ctx.drawImage(tempCanvas, 0, 0, width, height);

            // Only apply palette if it's not the natural palette
            const palette = palettes[selectedPalette];
            if (palette && palette.length > 0) {
                applyPalette(palette);
            }
            
            // Update background color based on the processed image
            if (selectedPalette === 'natural') {
                const bgColor = getImageBackgroundColor();
                if (bgColor) {
                    document.querySelector('.screen').style.backgroundColor = bgColor;
                } else {
                    document.querySelector('.screen').style.backgroundColor = '#f0f0f0';
                }
            } else {
                const bgColor = getImageBackgroundColor();
                if (bgColor) {
                    document.querySelector('.screen').style.backgroundColor = bgColor;
                }
            }
            
            status.textContent = `${pixelSizeValue}px Pixels • ${paletteNames[selectedPalette]}`;
        }

        function applyPalette(paletteColors) {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;

            for (let i = 0; i < data.length; i += 4) {
                const [r, g, b] = findNearestColor(data[i], data[i + 1], data[i + 2], paletteColors);
                data[i] = r;
                data[i + 1] = g;
                data[i + 2] = b;
            }

            ctx.putImageData(imageData, 0, 0);
        }

        function findNearestColor(r, g, b, palette) {
            if (!palette?.length) return [r, g, b];
            
            let minDistance = Infinity;
            let nearestColor = palette[0];
            
            for (const color of palette) {
                const distance = Math.pow(r - color[0], 2) + Math.pow(g - color[1], 2) + Math.pow(b - color[2], 2);
                if (distance < minDistance) {
                    minDistance = distance;
                    nearestColor = color;
                }
            }
            
            return nearestColor;
        }

        resetBtn.addEventListener('click', function() {
            if (!originalImage) return;
            
            const maxSize = 600;
            let width = originalImage.width;
            let height = originalImage.height;
            
            if (width > maxSize || height > maxSize) {
                const scale = Math.min(maxSize / width, maxSize / height);
                width = Math.round(width * scale);
                height = Math.round(height * scale);
            }

            canvas.width = width;
            canvas.height = height;
            ctx.imageSmoothingEnabled = true;
            ctx.clearRect(0, 0, width, height);
            ctx.drawImage(originalImage, 0, 0, width, height);
            
            status.textContent = `Reset to Original • ${paletteNames[selectedPalette]}`;
        });

        downloadBtn.addEventListener('click', function() {
            const link = document.createElement('a');
            link.download = 'pixel-art.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
            
            status.textContent = `Image Saved • ${paletteNames[selectedPalette]}`;
        });
    </script>
</body>
</html>